(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[382],{3375:(e,a,r)=>{Promise.resolve().then(r.bind(r,4960))},4960:(e,a,r)=>{"use strict";r.r(a),r.d(a,{default:()=>y});var t=r(5155),s=r(2115),n=r(6565),l=r(8719),i=r(5902),o=r(7984),c=r.n(o),d=r(6028),h=r(9780),u=r(9756),x=r(8391),j=r(2912),m=r(465),g=r(8095),p=r(4481);let y=()=>{let[e,a]=(0,s.useState)(""),[r,o]=(0,s.useState)([]),[y,_]=(0,s.useState)(),[b,f]=(0,s.useState)(!1),[C,w]=(0,s.useState)(!1),[v,N]=(0,s.useState)(""),[S,D]=(0,s.useState)(new Date),[E,k]=(0,s.useState)(),[L,A]=(0,s.useState)(!1);function I(){f(!1),_(null),w(!1),N(null),D(null),k(null)}(0,s.useEffect)(()=>{let a=async()=>{o(await (0,l.Ho)(e))};e.trim().length>1?a():o([])},[e]);let M=async()=>{await (0,l.KN)(y.id,v,S),w(!1),I(),a(""),o([]),A(!0),setTimeout(()=>A(!1),3e3)},F=async()=>{await (0,l.Fn)(y.id),w(!1),I(),a(""),o([]),A(!0),setTimeout(()=>A(!1),3e3)};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(i.A,{}),(0,t.jsxs)("main",{children:[(0,t.jsx)("h2",{children:"Search By Title / Author / Tag"}),(0,t.jsx)(n.p,{placeholder:"Search by title...",value:e,onChange:e=>a(e.value),className:c().search}),0===r.length&&e.trim().length>1?(0,t.jsx)("p",{children:"No results found."}):(0,t.jsx)("ul",{className:c().results,children:r.map(e=>(0,t.jsxs)("li",{onClick:a=>(function(e){f(!0),_(e),e.loaned.date&&function(e){let a=new Date,r=new Date(e),t=new Date(r.getFullYear(),r.getMonth(),r.getDate());k(Math.floor((new Date(a.getFullYear(),a.getMonth(),a.getDate())-t)/864e5))}(e.loaned.date)})(e),children:[(0,t.jsx)("strong",{children:e.title})," by ",e.author]},e.id))}),b&&y&&(0,t.jsxs)(d.l,{title:y.title,onClose:e=>I(),children:[(0,t.jsx)("img",{src:y.cover,className:c().cover}),(0,t.jsxs)("p",{children:[(0,t.jsx)("b",{children:"ISBN:"})," ",y.isbn]}),(0,t.jsxs)("p",{style:{textTransform:"capitalize"},children:[(0,t.jsx)("b",{children:"Title:"})," ",(0,t.jsx)("i",{children:y.title})]}),(0,t.jsxs)("p",{children:[(0,t.jsx)("b",{children:"Author(s):"})," ",y.author]}),(0,t.jsxs)("p",{children:[(0,t.jsx)("b",{children:"Publish Date:"})," ",y.published]}),(0,t.jsx)("p",{children:(0,t.jsx)("b",{children:"Tags:"})}),(0,t.jsx)("div",{className:c().tagContainer,children:y.tags&&y.tags.map(e=>(0,t.jsx)(x.Z,{className:c().tag,children:e}))}),y.loaned&&(0,t.jsx)(x.Z,{type:"warning",children:(0,t.jsxs)("p",{children:["Loaned to ",y.loaned.name," ",E," days ago."]})}),console.log(y),(0,t.jsxs)(h.f,{children:[!y.loaned&&(0,t.jsx)(u.$,{onClick:e=>w(!0),children:"Loan Media"}),y.loaned&&(0,t.jsx)(u.$,{onClick:e=>F(),children:"Return Loan"}),(0,t.jsx)(u.$,{onClick:e=>I(),children:"Close"})]})]}),C&&(0,t.jsxs)(d.l,{title:"Loan Book",onClose:e=>I(),children:[(0,t.jsxs)("div",{style:{marginBottom:"1rem"},children:[(0,t.jsx)("label",{children:"Borrower's Name"}),(0,t.jsx)(n.p,{value:v,onChange:e=>N(e.target.value),placeholder:"e.g. Alex"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{children:"Loan Date"}),(0,t.jsx)(g.lr,{value:S,onChange:e=>D(e.value)})]}),(0,t.jsxs)(h.f,{children:[(0,t.jsx)(u.$,{themeColor:"primary",onClick:e=>M(),children:"Save"}),(0,t.jsx)(u.$,{onClick:e=>I(),children:"Cancel"})]})]}),(0,t.jsx)(p.z,{enter:!0,exit:!0,children:L&&(0,t.jsx)(j.N,{className:c().position,children:(0,t.jsx)(m.E,{className:c().notification,type:{style:"success",icon:!0},closable:!0,onClose:()=>A(!1),children:(0,t.jsx)("p",{children:"Your loan data has been updated."})})})})]})]})}},5902:(e,a,r)=>{"use strict";r.d(a,{A:()=>o});var t=r(5155),s=r(9946),n=r(2241),l=r(8120),i=r.n(l);function o(){return(0,t.jsxs)(s.h,{className:i().header,children:[(0,t.jsx)(n.o,{children:(0,t.jsx)("h1",{children:"Media Library"})}),(0,t.jsxs)(n.o,{children:[(0,t.jsx)("a",{href:"/",children:"Add"}),(0,t.jsx)("a",{href:"/library",children:"Search"}),(0,t.jsx)("a",{href:"/browse",children:"Browse"})]})]})}},7984:e=>{e.exports={search:"library_search__JpV09",results:"library_results__8pyEX",cover:"library_cover__0I5EX",position:"library_position__DNc9j",notification:"library_notification__yHI9H",tagContainer:"library_tagContainer__EWpum",tag:"library_tag__VCFtS"}},8120:e=>{e.exports={header:"header_header__zSvjR"}},8719:(e,a,r)=>{"use strict";r.d(a,{NA:()=>i,xM:()=>o,Fn:()=>h,UC:()=>l,Ho:()=>c,KN:()=>d});var t=r(5317);let s=(0,r(3915).Wp)({apiKey:"AIzaSyCUm4lKOrEMD2NCf_OTNluVxfl_X_4XPF8",authDomain:"media-query-gn.firebaseapp.com",projectId:"media-query-gn",storageBucket:"media-query-gn.firebasestorage.app",messagingSenderId:"329944024899",appId:"1:329944024899:web:b8a9dc072c216b858191f6",measurementId:"G-M964RJ1DLQ"}),n=(0,t.aU)(s),l=async e=>{try{let a=await (0,t.gS)((0,t.rJ)(n,"media"),{...e});return console.log("Media saved with ID:",a.id),a.id}catch(e){console.error("Error saving media to Firestore:",e)}},i=async e=>{let a=(0,t.rJ)(n,"media"),r=(0,t.P)(a,(0,t._M)("isbn","==",e));return!(await (0,t.GG)(r)).empty},o=async()=>{try{return(await (0,t.GG)((0,t.rJ)(n,"media"))).docs.map(e=>({id:e.id,...e.data()}))}catch(e){return console.error("Error fetching media:",e),[]}},c=async e=>{if(!e.trim())return[];let a=(0,t.rJ)(n,"media"),r=(0,t.P)(a),s=await (0,t.GG)(r),l=e.toLowerCase();return s.docs.map(e=>({id:e.id,...e.data()})).filter(e=>{var a,r;let t=null==(a=e.title)?void 0:a.toLowerCase().includes(l),s=null==(r=e.author)?void 0:r.toLowerCase().includes(l),n=!!Array.isArray(e.tags)&&e.tags.some(e=>e.toLowerCase().includes(l));return t||s||n})},d=async(e,a,r)=>{try{let s=(0,t.H9)(n,"media",e);await (0,t.mZ)(s,{loaned:{name:a,date:r.toISOString()}})}catch(e){console.error("Error updating loan info:",e)}},h=async e=>{try{let a=(0,t.H9)(n,"media",e);await (0,t.mZ)(a,{loaned:!1})}catch(e){console.error("Error updating loan info:",e)}}}},e=>{var a=a=>e(e.s=a);e.O(0,[995,992,191,415,95,846,441,684,358],()=>a(3375)),_N_E=e.O()}]);